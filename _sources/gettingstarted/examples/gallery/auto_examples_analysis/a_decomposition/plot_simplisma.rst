
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/plot_simplisma.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gettingstarted_examples_gallery_auto_examples_analysis_a_decomposition_plot_simplisma.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gettingstarted_examples_gallery_auto_examples_analysis_a_decomposition_plot_simplisma.py:


SIMPLISMA example
-----------------
In this example, we perform the PCA dimensionality reduction of a spectra
dataset

.. GENERATED FROM PYTHON SOURCE LINES 17-18

Import the spectrochempy API package (and the SIMPLISMA model independently)

.. GENERATED FROM PYTHON SOURCE LINES 18-20

.. code-block:: Python

    import spectrochempy as scp








.. GENERATED FROM PYTHON SOURCE LINES 21-22

Load a matlab datasets

.. GENERATED FROM PYTHON SOURCE LINES 22-29

.. code-block:: Python

    print("Dataset (Jaumot et al., Chemometr. Intell. Lab. 76 (2005) 101-110)):")
    lnd = scp.read_matlab("matlabdata/als2004dataset.MAT", merge=False)
    for mat in lnd:
        print("    " + mat.name, str(mat.shape))

    ds = lnd[-1]
    ds.plot()



.. image-sg:: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_001.png
   :alt: plot simplisma
   :srcset: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Dataset (Jaumot et al., Chemometr. Intell. Lab. 76 (2005) 101-110)):
        cpure (204, 4)
        MATRIX (204, 96)
        isp_matrix (4, 4)
        spure (4, 96)
        csel_matrix (51, 4)
        m1 (51, 96)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">

    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 30-31

Add some metadata for a nicer display

.. GENERATED FROM PYTHON SOURCE LINES 31-39

.. code-block:: Python

    ds.title = "absorbance"
    ds.units = "absorbance"
    ds.set_coordset(None, None)
    ds.y.title = "elution time"
    ds.x.title = "wavelength"
    ds.y.units = "hours"
    ds.x.units = "nm"








.. GENERATED FROM PYTHON SOURCE LINES 40-41

Fit the SIMPLISMA model

.. GENERATED FROM PYTHON SOURCE LINES 41-45

.. code-block:: Python

    print("Fit SIMPLISMA on {}\n".format(ds.name))
    simpl = scp.SIMPLISMA(n_components=20, tol=0.2, noise=3, log_level="INFO")
    simpl.fit(ds)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Fit SIMPLISMA on m1

    /home/runner/work/spectrochempy/spectrochempy/.venv/lib/python3.13/site-packages/traitlets/traitlets.py:1568: UserWarning: SIMPLISMA does not handle easily negative values.
      c(event)
     *** Automatic SIMPL(I)SMA analysis ***
          dataset: m1
            noise: 3.0 %
              tol: 0.2 %
     n_components: 20
 

     #iter index_pc  coord_pc   Std(res)   R^2    
     ---------------------------------------------
        1      4       4.0     0.0263     0.9755 
        2     82      82.0     0.0100     0.9964 
        3     29      29.0     0.0072     0.9981 
     **** Unexplained variance lower than 'tol' (0.2 %)
     **** End of SIMPL(I)SMA analysis.

    <spectrochempy.analysis.decomposition.simplisma.SIMPLISMA object at 0x7fb502322a50>



.. GENERATED FROM PYTHON SOURCE LINES 46-47

Plot concentration

.. GENERATED FROM PYTHON SOURCE LINES 47-48

.. code-block:: Python

    simpl.C.T.plot(title="Concentration")



.. image-sg:: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_002.png
   :alt: Concentration
   :srcset: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_002.png
   :class: sphx-glr-single-img



.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">

    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 49-50

Plot components (St)

.. GENERATED FROM PYTHON SOURCE LINES 50-53

.. code-block:: Python



    simpl.components.plot(title="Pure profiles")



.. image-sg:: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_003.png
   :alt: Pure profiles
   :srcset: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_003.png
   :class: sphx-glr-single-img



.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">

    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 55-57

Show the plot of merit
after reconstruction oto the original data space

.. GENERATED FROM PYTHON SOURCE LINES 57-59

.. code-block:: Python

    simpl.plotmerit(offset=0, nb_traces=5)




.. image-sg:: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_004.png
   :alt: SIMPLISMA plot of merit
   :srcset: /gettingstarted/examples/gallery/auto_examples_analysis/a_decomposition/images/sphx_glr_plot_simplisma_004.png
   :class: sphx-glr-single-img



.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">

    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 60-62

This ends the example ! The following line can be uncommented if no plot shows when
running the .py script with python

.. GENERATED FROM PYTHON SOURCE LINES 62-64

.. code-block:: Python


    # scp.show()








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.798 seconds)


.. _sphx_glr_download_gettingstarted_examples_gallery_auto_examples_analysis_a_decomposition_plot_simplisma.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_simplisma.ipynb <plot_simplisma.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_simplisma.py <plot_simplisma.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_simplisma.zip <plot_simplisma.zip>`
